<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lost? Catch the Ghosts!</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family:system-ui,Arial,sans-serif;
      background:linear-gradient(135deg,#1a1a2e,#16213e,#0f3460);
      color:#fff;
      min-height:100vh;
      overflow:hidden;
      display:flex;
      flex-direction:column;
    }
    .header{
      display:flex; justify-content:space-between; align-items:center;
      padding:15px 30px;
      background:rgba(0,0,0,0.3);
      backdrop-filter:blur(10px);
      z-index:10;
    }
    .logo{font-size:1.2rem;font-weight:600;color:#e94560;}
    .stats{display:flex;gap:25px;font-size:1.1rem;}
    .stat-value{font-weight:bold;color:#4ecca3;font-size:1.3rem;}
    #gameArea{position:relative;flex:1;cursor:crosshair;}
    .ghost{
      position:absolute;
      font-size:50px;
      user-select:none;
      cursor:pointer;
      transition:transform .15s ease;
      filter:drop-shadow(0 0 10px rgba(233,69,96,.5));
      animation:float 2s ease-in-out infinite;
    }
    .ghost:hover{transform:scale(1.2);}
    .ghost:active{transform:scale(.9);}
    @keyframes float{
      0%,100%{transform:translateY(0);}
      50%{transform:translateY(-15px);}
    }
    .scorePopup{
      position:absolute;
      font-size:24px;
      font-weight:bold;
      color:#4ecca3;
      pointer-events:none;
      animation:popUp .8s ease-out forwards;
      text-shadow:0 2px 10px rgba(0,0,0,.5);
    }
    @keyframes popUp{
      0%{opacity:1;transform:translateY(0) scale(1);}
      100%{opacity:0;transform:translateY(-50px) scale(1.5);}
    }
    #startScreen,#endScreen{
      position:absolute;top:0;left:0;width:100%;height:100%;
      background:rgba(0,0,0,.85);
      display:flex;flex-direction:column;justify-content:center;align-items:center;
      z-index:200;
    }
    #endScreen{display:none;}
    .screen-title{font-size:3rem;margin-bottom:20px;text-align:center;text-shadow:0 0 20px rgba(233,69,96,.5);}
    .screen-subtitle{font-size:1.2rem;color:#aaa;margin-bottom:40px;text-align:center;max-width:400px;line-height:1.6;}
    .btn{
      padding:15px 50px;
      font-size:1.3rem;
      font-weight:bold;
      border:none;border-radius:50px;
      cursor:pointer;
      background:linear-gradient(135deg,#e94560,#c23a51);
      color:#fff;
      box-shadow:0 5px 20px rgba(233,69,96,.4);
      transition:all .3s ease;
    }
    .btn:hover{transform:translateY(-3px);box-shadow:0 8px 30px rgba(233,69,96,.6);}
    .btn:active{transform:translateY(0);}
    .final-score{font-size:5rem;font-weight:bold;color:#4ecca3;margin:20px 0;text-shadow:0 0 30px rgba(78,204,163,.5);}
    .high-score{font-size:1.2rem;color:#ffd700;margin-bottom:30px;}
    .progress-container{
      position:absolute;bottom:20px;left:50%;transform:translateX(-50%);
      width:300px;height:10px;background:rgba(255,255,255,.2);
      border-radius:10px;overflow:hidden;
    }
    .progress-bar{
      height:100%;background:linear-gradient(90deg,#e94560,#4ecca3);
      width:100%;transition:width 1s linear;
    }
    .instructions{
      position:absolute;bottom:45px;left:50%;transform:translateX(-50%);
      font-size:.9rem;color:#888;
    }
    .ghost.normal{filter:drop-shadow(0 0 8px rgba(255,255,255,.3));}
    .ghost.fast{filter:drop-shadow(0 0 15px rgba(233,69,96,.8));animation-duration:.8s;}
    .ghost.tiny{font-size:30px;filter:drop-shadow(0 0 5px rgba(78,204,163,.8));}
    .ghost.big{font-size:70px;filter:drop-shadow(0 0 20px rgba(255,215,0,.8));}
  </style>
</head>
<body>

  <!-- Header -->
  <div class="header">
    <div class="logo">ðŸ‘» Ghost Catcher</div>
    <div class="stats">
      <div class="stat">Score: <span class="stat-value" id="score">0</span></div>
      <div class="stat">Time: <span class="stat-value" id="time">30</span>s</div>
      <div class="stat">Level: <span class="stat-value" id="level">1</span></div>
    </div>
  </div>

  <!-- Game area -->
  <div id="gameArea"></div>

  <!-- Progress bar -->
  <div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
  <div class="instructions">Click ghosts â€“ bigger = more points, faster = harder.</div>

  <!-- Start screen -->
  <div id="startScreen">
    <div class="screen-title">ðŸ‘» Lost? Catch Some Ghosts!</div>
    <div class="screen-subtitle">
      You've stumbled onto a 404 page, but don't be sad!<br><br>
      ðŸŽ¯ Click ghosts to score<br>
      âš¡ Faster ghosts = more points<br>
      ðŸ”¥ Bigger ghosts = bonus points
    </div>
    <button class="btn" onclick="startGame()">Start Game</button>
  </div>

  <!-- End screen -->
  <div id="endScreen">
    <div class="screen-title">Time's Up!</div>
    <div class="final-score" id="finalScore">0</div>
    <div class="high-score" id="highScoreText">New High Score!</div>
    <div class="screen-subtitle" id="endMessage"></div>
    <button class="btn" onclick="startGame()">Play Again</button>
  </div>

  <script>
    // ----------------------- Game state -----------------------
    let score = 0;
    let timeLeft = 30;
    let level = 1;
    let gameInterval, spawnInterval;
    let ghostId = 0;
    let highScore = localStorage.getItem('ghostHighScore') || 0;
    let isPlaying = false;

    // Ghost definitions
    const ghostTypes = [
      {type:'normal',emoji:'ðŸ‘»',points:10,minSize:50,maxSize:60,speed:2000,chance:0.5},
      {type:'fast',emoji:'ðŸ’¨',points:25,minSize:40,maxSize:50,speed:800,chance:0.25},
      {type:'tiny',emoji:'ðŸ‘€',points:50,minSize:25,maxSize:35,speed:1500,chance:0.15},
      {type:'big',emoji:'ðŸ‘¹',points:100,minSize:70,maxSize:90,speed:2500,chance:0.1}
    ];

    // DOM shortcuts
    const gameArea   = document.getElementById('gameArea');
    const scoreEl    = document.getElementById('score');
    const timeEl     = document.getElementById('time');
    const levelEl    = document.getElementById('level');
    const progress   = document.getElementById('progressBar');
    const startScr   = document.getElementById('startScreen');
    const endScr     = document.getElementById('endScreen');
    const finalScore= document.getElementById('finalScore');
    const highScoreT = document.getElementById('highScoreText');
    const endMsg    = document.getElementById('endMessage');

    // ----------------------- Core functions -----------------------
    function startGame(){
      score = 0; timeLeft = 30; level = 1; isPlaying = true; ghostId = 0;
      scoreEl.textContent = score;
      timeEl.textContent = timeLeft;
      levelEl.textContent = level;
      progress.style.width = '100%';
      startScr.style.display='none';
      endScr.style.display='none';
      gameArea.innerHTML='';

      gameInterval = setInterval(updateTimer,1000);
      spawnGhost();                               // first ghost immediately
      spawnInterval = setInterval(spawnGhost, getSpawnRate());
    }

    function updateTimer(){
      timeLeft--;
      timeEl.textContent = timeLeft;
      progress.style.width = (timeLeft/30*100)+'%';

      // level up every 10 seconds
      if(timeLeft===20 || timeLeft===10){
        level++; levelEl.textContent = level;
        clearInterval(spawnInterval);
        spawnInterval = setInterval(spawnGhost, getSpawnRate());
      }

      if(timeLeft<=0) endGame();
    }

    function getSpawnRate(){
      // faster spawns as level rises, but never below 400â€¯ms
      return Math.max(400,1200-(level*100));
    }

    function spawnGhost(){
      if(!isPlaying) return;

      // ---- choose ghost type based on weighted chances ----
      const r = Math.random();
      let cumulative = 0, chosen = ghostTypes[0];
      for(const g of ghostTypes){
        cumulative += g.chance;
        if(r <= cumulative){ chosen = g; break; }
      }

      // ---- size and position ----
      const size = Math.floor(Math.random()*(chosen.maxSize-chosen.minSize+1))+chosen.minSize;
      const ghost = document.createElement('div');
      ghost.className = `ghost ${chosen.type}`;
      ghost.textContent = chosen.emoji;
      ghost.style.fontSize = size+'px';
      ghost.dataset.points = chosen.points;
      ghost.dataset.id = ghostId++;

      const maxX = gameArea.clientWidth - size;
      const maxY = gameArea.clientHeight - size - 30; // keep away from header
      ghost.style.left = Math.random()*maxX+'px';
      ghost.style.top  = Math.random()*maxY+'px';

      // ---- click handler ----
      ghost.addEventListener('click', e=>{
        if(!isPlaying) return;
        e.stopPropagation();
        const pts = parseInt(ghost.dataset.points);
        score += pts;
        scoreEl.textContent = score;
        showScorePopup(e.clientX, e.clientY, pts);
        ghost.remove();
      });

      gameArea.appendChild(ghost);

      // ---- autoâ€‘remove after its life time (harder as level â†‘) ----
      const life = Math.max(1500, chosen.speed - (level*100));
      setTimeout(()=>{
        if(ghost.parentNode){
          ghost.style.opacity='0';
          ghost.style.transition='opacity .3s';
          setTimeout(()=>ghost.remove(),300);
        }
      },life);
    }

    function showScorePopup(x,y,pts){
      const pop = document.createElement('div');
      pop.className='scorePopup';
      pop.textContent='+'+pts;
      pop.style.left = x+'px';
      pop.style.top  = y+'px';
      document.body.appendChild(pop);
      setTimeout(()=>pop.remove(),800);
    }

    function endGame(){
      isPlaying = false;
      clearInterval(gameInterval);
      clearInterval(spawnInterval);

      const newHigh = score > highScore;
      if(newHigh){
        highScore = score;
        localStorage.setItem('ghostHighScore',highScore);
      }

      finalScore.textContent = score;
      highScoreT.style.display = newHigh ? 'block' : 'none';
      highScoreT.textContent = newHigh ? 'ðŸ† New High Score!' : `High Score: ${highScore}`;

      let msg = '';
      if(score>=500) msg='Incredible! You are a ghostâ€‘catching master!';
      else if(score>=300) msg='Great job! Those ghosts never stood a chance.';
      else if(score>=150) msg='Nice work! Keep practicing to catch more.';
      else if(score>=50)  msg='Not bad! Try again to improve your score.';
      else                msg='Those ghosts got away this time. Want to retry?';
      endMsg.textContent = msg;

      endScr.style.display='flex';
    }

    // keep ghosts inside the viewport on resize
    window.addEventListener('resize',()=>{
      document.querySelectorAll('.ghost').forEach(g=>{
        const maxX = gameArea.clientWidth - parseInt(g.style.fontSize);
        const maxY = gameArea.clientHeight - parseInt(g.style.fontSize) - 30;
        if(parseInt(g.style.left)>maxX) g.style.left = maxX+'px';
        if(parseInt(g.style.top)>maxY)  g.style.top  = maxY+'px';
      });
    });
  </script>

  <!-- ==================== Buy Me a Coffee ==================== -->
  <div style="
        position:fixed;
        bottom:80px;
        left:50%;
        transform:translateX(-50%);
        text-align:center;
        z-index:50;
        width:100%;
        max-width:400px;">
    <p style="color:#888;font-size:.9rem;margin-bottom:10px;">
      While you're hereâ€¦
    </p>
    <a href="https://buymeacoffee.com/warlockholmes"
       target="_blank"
       style="
         display:inline-block;
         background:#ffdd00;
         color:#000;
         padding:12px 24px;
         border-radius:8px;
         text-decoration:none;
         font-weight:bold;
         font-size:1rem;
         box-shadow:0 4px 15px rgba(255,221,0,.4);">
      â˜• Buy me a coffee
    </a>
  </div>
</body>
</html>
